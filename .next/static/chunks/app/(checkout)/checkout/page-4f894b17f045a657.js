(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[101],{5742:(e,t,r)=>{Promise.resolve().then(r.bind(r,7669))},7669:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>B});var a=r(5155),s=r(2115),i=r(9606),l=r(2679),n=r(7501),d=r(9602);let c=e=>{let{title:t,endAdornment:r,className:s,contentClassName:i,children:l}=e;return(0,a.jsxs)("div",{className:(0,d.cn)("bg-white rounded-3xl",s),children:[t&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-5 px-7 border-b border-gray-100",children:[(0,a.jsx)(n.h,{text:t,size:"sm",className:"font-bold"}),r]}),(0,a.jsx)("div",{className:(0,d.cn)("px-5 py-4",i),children:l})]})};var o=r(5128),m=r(5686);let x=e=>{let{imageUrl:t,name:r,price:s,quantity:i,details:l,disabled:n,onClickCountButton:c,onClickRemove:o,className:x}=e;return(0,a.jsxs)("div",{className:(0,d.cn)("flex flex-col md:flex-row bg-white p-5 gap-6",{"opacity-50 pointer-events-none":n},x),children:[(0,a.jsx)("img",{src:t,alt:r,className:"w-24 h-24 md:w-32 md:h-32 object-cover"}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col md:flex-row justify-between",children:[(0,a.jsxs)("div",{className:"md:mr-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:r}),(0,a.jsx)("p",{className:"text-gray-500",children:l})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between md:justify-end mt-4 md:mt-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>c&&c("minus"),className:(0,d.cn)("bg-gray-200 px-2 py-1 rounded",{"opacity-50 pointer-events-none":1===i}),disabled:1===i,children:"-"}),(0,a.jsx)("span",{children:i}),(0,a.jsx)("button",{type:"button",onClick:()=>c&&c("plus"),className:"bg-gray-200 px-2 py-1 rounded",children:"+"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 ml-4",children:[(0,a.jsxs)("span",{className:"text-gray-700",children:["₽ ",s.toFixed(2)]}),(0,a.jsx)("button",{type:"button",onClick:o,className:"text-gray-400 cursor-pointer hover:text-gray-600",children:(0,a.jsx)(m.A,{size:16})})]})]})]})]})},u=[{name:"Маленькая",value:"20"},{name:"Средняя",value:"30"},{name:"Большая",value:"40"}],p=[{name:"Традиционное",value:"1"},{name:"Тонкое",value:"2"}],g=e=>{let{className:t}=e,{items:r,totalAmount:i,fetchCartItems:l,error:n,updateItemQuantity:m,removeCartItem:g}=(0,o.x)();(0,s.useEffect)(()=>{l()},[l]);let h=e=>{var t,r;let s=null==u?void 0:null===(t=u.find(t=>{var r;return t.value===(null===(r=e.pizzaSize)||void 0===r?void 0:r.toString())}))||void 0===t?void 0:t.name,i=null==p?void 0:null===(r=p.find(t=>{var r;return t.value===(null===(r=e.type)||void 0===r?void 0:r.toString())}))||void 0===r?void 0:r.name,l=null==e?void 0:e.ingredients.map(e=>null==e?void 0:e.name).join(", ");return(0,a.jsxs)(a.Fragment,{children:["Размер: ",s||"-",(0,a.jsx)("br",{}),"Тип теста: ",i||"-",(0,a.jsx)("br",{}),"Ингредиенты: ",l||"-"]})};return n?(0,a.jsx)("div",{children:"Ошибка загрузки корзины"}):(0,a.jsx)(c,{title:"1. Корзина",className:(0,d.cn)("p-5",t),children:r.length>0?r.map(e=>(0,a.jsx)(x,{imageUrl:e.imageUrl,name:e.name,price:e.price,quantity:e.quantity,details:h(e),onClickCountButton:t=>{let r="plus"===t?e.quantity+1:e.quantity-1;m(e.id,r)},onClickRemove:()=>g(e.id)},e.id)):(0,a.jsx)("div",{children:"Ваша корзина пуста"})})},h=()=>(0,a.jsx)("span",{className:"text-red-500",children:"*"});var v=r(2336);let f=e=>{let{text:t,className:r}=e;return(0,a.jsx)("p",{className:(0,d.cn)("text-red-500 text-sm",r),children:t})};var y=r(767);let b=e=>{let{onClick:t,className:r}=e;return(0,a.jsx)("button",{onClick:t,className:(0,d.cn)("absolute right-4 top-1/2 -translate-y-1/2 opacity-30 hover:opacity-100 cursor-pointer",r),children:(0,a.jsx)(y.A,{className:"h-5 w-5"})})},j=e=>{var t;let{className:r,name:s,label:l,required:n,...c}=e,{register:o,formState:{errors:m},watch:x,setValue:u}=(0,i.xW)(),p=x(s);return(0,a.jsxs)("div",{className:(0,d.cn)(r),children:[l&&(0,a.jsxs)("p",{className:"font-medium mb-2",children:[l," ",n&&(0,a.jsx)(h,{})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(v.p,{className:"h-12 text-md",...c,...o(s,{required:!!n&&"Поле обязательно для заполнения"})}),p&&(0,a.jsx)(b,{onClick:()=>{u(s,"")}})]}),m[s]&&(0,a.jsx)(f,{text:null===(t=m[s])||void 0===t?void 0:t.message,className:"mt-2"})]})},N=e=>{let{form:t}=e;return(0,a.jsx)(c,{title:"1. Персональные данные",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,a.jsx)(j,{name:"firstName",className:"text-base",placeholder:"Имя"}),(0,a.jsx)(j,{name:"lastName",className:"text-base",placeholder:"Фамилия"}),(0,a.jsx)(j,{name:"email",className:"text-base",placeholder:"Email"}),(0,a.jsx)(j,{name:"phone",className:"text-base",placeholder:"Телефон"})]})})};var z=r(7243);r(3207);let w=e=>{let{onChange:t}=e;return(0,a.jsx)(z.OO,{token:"b5b8bb983ddcd08648080e0271d9dd367bb7aa65",onChange:e=>null==t?void 0:t(null==e?void 0:e.value)})},I=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("textarea",{className:(0,d.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...s})});I.displayName="Textarea";let q=e=>{var t;let{className:r,name:s,label:l,required:n,...d}=e,{register:c,formState:{errors:o},watch:m,setValue:x}=(0,i.xW)(),u=m(s),p=null===(t=o[s])||void 0===t?void 0:t.message;return(0,a.jsxs)("div",{className:r,children:[(0,a.jsxs)("p",{className:"font-medium mb-2",children:[l," ",n&&(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(I,{className:"h-12 text-md",...c(s),...d}),u&&(0,a.jsx)(b,{onClick:()=>{x(s,"")}})]}),p&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-2",children:p})]})},A=e=>{let{className:t}=e,{control:r}=(0,i.xW)();return(0,a.jsx)(c,{title:"3. Адрес доставки",className:t,children:(0,a.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,a.jsx)(i.xI,{control:r,name:"address",render:e=>{var t;let{field:r,fieldState:s}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w,{onChange:r.onChange}),(null===(t=s.error)||void 0===t?void 0:t.message)&&(0,a.jsx)(f,{text:s.error.message})]})}}),(0,a.jsx)(q,{name:"comment",className:"text-base",placeholder:"Комментарий к заказу",rows:5})]})})},C=e=>{let{title:t,value:r,className:s}=e;return(0,a.jsxs)("div",{className:(0,d.cn)("flex my-4",s),children:[(0,a.jsxs)("span",{className:"flex flex-1 text-lg text-neutral-500",children:[t,(0,a.jsx)("div",{className:"flex-1 border-b border-dashed border-b-neutral-200 relative -top-1 mx-2"})]}),(0,a.jsx)("span",{className:"font-bold text-lg",children:r})]})};var k=r(4085),S=r(719),U=r(4226),E=r(5844),F=r(9053);let R=e=>{let{className:t}=e,{totalAmount:r}=(0,o.x)(),s=.15*r,i=r+s+250;return(0,a.jsxs)(c,{className:(0,d.cn)("p-6 sticky top-4",t),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("span",{className:"text-xl",children:"Итого:"}),(0,a.jsxs)("span",{className:"h-11 text-[34px] font-extrabold",children:[i.toFixed(2)," ₽"]})]}),(0,a.jsx)(C,{title:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(S.A,{size:18,className:"mr-2 text-gray-400"}),"Стоимость корзины:"]}),value:"".concat(r.toFixed(2)," ₽")}),(0,a.jsx)(C,{title:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(U.A,{size:18,className:"mr-2 text-gray-400"}),"Налоги:"]}),value:"".concat(s.toFixed(2)," ₽")}),(0,a.jsx)(C,{title:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(E.A,{size:18,className:"mr-2 text-gray-400"}),"Доставка:"]}),value:"".concat("250.00"," ₽")}),(0,a.jsxs)(k.$,{type:"submit",className:"w-full h-14 rounded-2xl mt-6 text-base font-bold",children:["Перейти к оплате",(0,a.jsx)(F.A,{className:"w-5 ml-2"})]})]})};var O=r(3415);let _=O.z.object({firstName:O.z.string().min(2,{message:"Имя должно содержать не менее 2-х символов"}),lastName:O.z.string().min(2,{message:"Фамилия должна содержать не менее 2-х символов"}),email:O.z.string().email({message:"Введите корректную почту"}),phone:O.z.string().min(10,{message:"Введите корректный номер телефона"}),address:O.z.string().min(5,{message:"Введите корректный адрес"}),comment:O.z.string().optional()});var T=r(5828);let W=(0,T.createServerReference)("40104ba4260988b62e2bd259e9766a8cafed8eded8",T.callServer,void 0,T.findSourceMapURL,"createOrder");var $=r(5037);function B(e){let{className:t}=e,r=(0,i.mN)({resolver:(0,l.u)(_),defaultValues:{email:"",firstName:"",lastName:"",phone:"",address:"",comment:""}}),s=async e=>{try{let t=await W(e);$.Ay.success("Заказ успешно оформлен! Переход на оплату..."),t&&(location.href=t)}catch(e){console.log(e),$.Ay.error("Не удалось создать заказ...")}};return(0,a.jsxs)("div",{className:"pt-5",children:[(0,a.jsx)(n.h,{size:"xl",className:"font-extrabold mb-8",text:"Оформление заказа"}),(0,a.jsx)(i.Op,{...r,children:(0,a.jsx)("form",{onSubmit:r.handleSubmit(s),children:(0,a.jsxs)("div",{className:"flex gap-10",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-10 flex-1 mb-20",children:[(0,a.jsx)(g,{}),(0,a.jsx)(N,{form:r}),(0,a.jsx)(A,{})]}),(0,a.jsx)(R,{className:"w-[450px]"})]})})})]})}},4085:(e,t,r)=>{"use strict";r.d(t,{$:()=>o});var a=r(5155),s=r(2115),i=r(4707),l=r(652),n=r(9602),d=r(7594);let c=(0,l.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md active:translate-y-[1px] text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 disabled:bg-gray-500",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-primary text-primary bg-transparent hover:bg-secondary",secondary:"bg-secondary text-primary hover:bg-secondary/50",ghost:"hover:bg-secondary hover:text-secondary-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef((e,t)=>{let{className:r,variant:s,size:l,asChild:o=!1,children:m,disabled:x,loading:u,...p}=e,g=o?i.DX:"button";return(0,a.jsx)(g,{disabled:x||u,className:(0,n.cn)(c({variant:s,size:l,className:r})),ref:t,...p,children:u?(0,a.jsx)(d.A,{className:"w-5 h-5 animate-spin"}):m})});o.displayName="Button"},2336:(e,t,r)=>{"use strict";r.d(t,{p:()=>l});var a=r(5155),s=r(2115),i=r(9602);let l=s.forwardRef((e,t)=>{let{className:r,type:s,...l}=e;return(0,a.jsx)("input",{type:s,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...l})});l.displayName="Input"},5786:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=r(2651).A.create({baseURL:"http://localhost:3000/api"})},9602:(e,t,r)=>{"use strict";r.d(t,{cn:()=>i});var a=r(3463),s=r(9795);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},7501:(e,t,r)=>{"use strict";r.d(t,{h:()=>i});var a=r(3463),s=r(2115);let i=e=>{let{text:t,size:r="sm",className:i}=e;return s.createElement({xs:"h5",sm:"h4",md:"h3",lg:"h2",xl:"h1","2xl":"h1"}[r],{className:(0,a.A)({xs:"text-[16px]",sm:"text-[22px]",md:"text-[26px]",lg:"text-[32px]",xl:"text-[40px]","2xl":"text-[48px]"}[r],i)},t)}},5128:(e,t,r)=>{"use strict";r.d(t,{x:()=>d});var a=r(5786);let s=async()=>{try{return(await a.A.get("/cart")).data}catch(e){console.log("Error fetching data:",e)}},i=async(e,t)=>{try{return(await a.A.patch("/cart/".concat(e),{quantity:t})).data}catch(e){console.log("Error updating cart item quantity:",e)}},l=async e=>{try{return(await a.A.delete("/cart/".concat(e))).data}catch(e){console.log("Error removing cart item:",e)}},n=async(e,t)=>{try{return(await a.A.post("/cart",{productItemId:e,ingredients:t})).data}catch(e){console.log("Error adding item to cart:",e)}},d=(0,r(9827).v)((e,t)=>({items:[],error:!1,loading:!0,totalAmount:0,fetchCartItems:async()=>{try{e({loading:!0,error:!1});let t=(await s()).items.map(e=>{let t=e.ingredients.reduce((e,t)=>e+t.price,0),r=(e.productItem.price+t)*e.quantity;return{id:e.id,quantity:e.quantity,name:e.productItem.product.name,imageUrl:e.productItem.product.imageUrl,price:r,pizzaSize:e.productItem.size,type:e.productItem.pizzaType,ingredients:e.ingredients}}),r=t.reduce((e,t)=>e+t.price,0);e({items:t,totalAmount:r})}catch(t){console.log(t),e({error:!0})}finally{e({loading:!1})}},removeCartItem:async t=>{try{e({loading:!0,error:!1});let r=(await l(t.toString())).items.map(e=>{let t=e.ingredients.reduce((e,t)=>e+t.price,0),r=(e.productItem.price+t)*e.quantity;return{id:e.id,quantity:e.quantity,name:e.productItem.product.name,imageUrl:e.productItem.product.imageUrl,price:r,pizzaSize:e.productItem.size,type:e.productItem.pizzaType,ingredients:e.ingredients}}),a=r.reduce((e,t)=>e+t.price,0);e({items:r,totalAmount:a})}catch(t){console.log(t),e({error:!0})}finally{e({loading:!1})}},updateItemQuantity:async(t,r)=>{try{e({loading:!0,error:!1});let a=(await i(t.toString(),r)).items.map(e=>{let t=e.ingredients.reduce((e,t)=>e+t.price,0),r=(e.productItem.price+t)*e.quantity;return{id:e.id,quantity:e.quantity,name:e.productItem.product.name,imageUrl:e.productItem.product.imageUrl,price:r,pizzaSize:e.productItem.size,type:e.productItem.pizzaType,ingredients:e.ingredients}}),s=a.reduce((e,t)=>e+t.price,0);e({items:a,totalAmount:s})}catch(t){console.log(t),e({error:!0})}finally{e({loading:!1})}},addCartItem:async t=>{try{e({loading:!0,error:!1});let r=(await n(t.productItemId,t.ingredients)).items.map(e=>{let t=e.ingredients.reduce((e,t)=>e+t.price,0),r=(e.productItem.price+t)*e.quantity;return{id:e.id,quantity:e.quantity,name:e.productItem.product.name,imageUrl:e.productItem.product.imageUrl,price:r,pizzaSize:e.productItem.size,type:e.productItem.pizzaType,ingredients:e.ingredients}}),a=r.reduce((e,t)=>e+t.price,0);e({items:r,totalAmount:a})}catch(t){console.log(t),e({error:!0})}finally{e({loading:!1})}}}))}},e=>{var t=t=>e(e.s=t);e.O(0,[734,359,37,574,767,441,517,977],()=>t(5742)),_N_E=e.O()}]);